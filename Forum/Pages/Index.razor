@page "/"
@attribute [Authorize]
@using Microsoft.EntityFrameworkCore;
@using System.Security.Claims;
@inject IDbContextFactory<Model.Database> DbFactory;

<h1>You can only see this if you're authorized.</h1>
@*<h1>Hello, world!</h1>
<button @onclick="AddUser">Add User</button>

Welcome to your new app.*@

<AuthorizeView>
	<Authorized>
		<label>Hello @context.User.Identity.Name!</label>
		<ul>
			@foreach (Claim claim in @context.User.Claims)
			{
				<li>@claim.Type: @claim.Value</li>
			}
		</ul>
	</Authorized>
	<NotAuthorized>
		<label><b style="color: red;">You are not authorized.</b></label>
	</NotAuthorized>
</AuthorizeView>

@code {
	//private async Task AddUser()
	//{
	//	using var db = DbFactory.CreateDbContext();

	//	Entity.User user = new Entity.User()
	//	{
	//		AccountName = "MyAccName",
	//		Email = "myacc@name.ch",
	//		PwHash = "imaginethisisahash"
	//	};

	//	await db.Users.AddAsync(user);
	//	await db.SaveChangesAsync();
	//}
}