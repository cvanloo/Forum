@using Markdig
@* ReSharper disable once InconsistentNaming *@
@inject Ganss.XSS.IHtmlSanitizer HtmlSanitizer

<style>
	.md-view {
		font-family: "JetBrains Mono", monospace;
		color: #ebdbb2;
	}
	.md-view h1 {
		color: #98971A;
	}
	
	.md-view h2 {
		color: #99591A;
	}
	
	.md-view h3 {
		color: #e83e8c;
	}
	
	.md-view h4, .md-view h5, .md-view h6 {
		color: #FFF;
	}
</style>

<div class="md-view">
	@HtmlContent
</div>

@code {
	private string _content;

	[Parameter]
	public string Content
	{
		get => _content;
		set
		{
			_content = value;
			HtmlContent = ConvertToMarkup(_content);
		}
	}

	private MarkupString HtmlContent { get; set; }

	private MarkupString ConvertToMarkup(string value)
	{
		if (string.IsNullOrWhiteSpace(value))
			return new MarkupString();

		var html = Markdown.ToHtml(value, new MarkdownPipelineBuilder().UseAdvancedExtensions().Build());
		var sanitizedHtml = HtmlSanitizer.Sanitize(html);

		return new MarkupString(sanitizedHtml);
	}

}